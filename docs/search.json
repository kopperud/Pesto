[{"path":"/articles/Rate-analysis.html","id":"setting-up-the-model","dir":"Articles","previous_headings":"","what":"Setting up the model","title":"Rate analysis","text":"model use three hyperparameters: \\(\\hat{\\lambda}\\), \\(\\hat{\\mu}\\) \\(\\eta\\). appropriate values \\(\\hat{\\lambda}\\) \\(\\hat{\\mu}\\)? One approach use -called empirical hyperpriors parameters. Meaning, estimate \\(\\hat{\\lambda}\\) \\(\\hat{\\mu}\\) using simpler model: constant-rate reconstructed birth-death process uniform taxon sampling. reasonable starting point \\(\\hat{\\lambda}\\) \\(\\hat{\\mu}\\), can start setting state-dependent birth-death model. Suppose want allow \\(\\lambda\\) \\(\\mu\\) vary range different values. Ideally, want cover possible values: continuous range starting 0.0 infinity. However, now integrate infinitely large state space. Instead, can select finite sample values. Let’s say \\(\\lambda\\) \\(\\mu\\) log-normally distributed, pick \\(n\\) points evenly spaced across cumulative density function. values now \\(\\vec{\\lambda}\\) \\(\\vec{\\mu}\\):  \\(\\eta\\)? One approach can find maximum-likelihood estimate \\(\\eta\\) conditional \\(\\vec{\\lambda}\\) \\(\\vec{\\mu}\\). function optimize_eta optimize \\(\\eta\\) using gradient descent. procedure typically needs evaluate likelihood (derivative likelihood respect \\(\\eta\\)) function around 20-60 times reaching convergence, instantaneous.","code":"mlrates <- estimate_constant_bdp(primates, rho)  hatlambda <- mlrates$lambda hatmu <- mlrates$mu n <- 6 H <- 0.578  lambda_quantiles <- lognorm_quantiles(meanlog = log(hatlambda), sdlog = H, n = n) mu_quantiles <- lognorm_quantiles(meanlog = log(hatmu), sdlog = H, n = n)  ## Let's pick all pairwise combinations among these quantiles pairs <- allpairwise(lambda_quantiles, mu_quantiles) lambda <- pairs[[1]] mu <- pairs[[2]] plot(lambda, mu, pch = 19, xlab = \"lambda\", ylab = \"mu\") eta <- optimize_eta(lambda, mu, primates, rho)"},{"path":"/articles/Rate-analysis.html","id":"calculating-the-branch-rates","dir":"Articles","previous_headings":"","what":"Calculating the branch rates","title":"Rate analysis","text":"Now parameters \\(\\vec{\\lambda}\\), \\(\\vec{\\mu}\\) \\(\\eta\\), can compute expected rates across branches: return object treedata object, includes tree metadata. can plot results like :","code":"td <- birth_death_shift(primates, lambda, mu, eta, rho) p1 <- ggtree(td, aes(color = `Speciation rate`)) +              geom_tiplab(size = 2) +              theme(legend.position = c(0.1, 0.8)) +              xlim(c(0.0, th + 10)) plot(p1)"},{"path":"/articles/Rate-analysis.html","id":"calculating-the-number-of-shifts","dir":"Articles","previous_headings":"","what":"Calculating the number of shifts","title":"Rate analysis","text":"can also calculate expected number shifts model.  prior, expect \\(\\eta \\sum b_i\\) number shifts across phylogeny, \\(b_i\\) branch length branch \\(\\): posterior estimate number state changes highly correlated prior, exactly , slightly less:","code":"td <- compute_nshifts(primates, lambda, mu, eta, rho)  p2 <- ggtree(td, aes(color = nshifts)) +              geom_tiplab(size = 1) +              theme(legend.position = c(0.1, 0.8)) +              xlim(c(0.0, th + 10)) +              scale_colour_gradient(low = \"black\", high = \"red\") plot(p2) Nprior = eta * sum(primates$edge.length) print(Nprior) #> [1] 6.175928 Nposterior = sum(td@data$nshifts) print(Nposterior) #> [1] 5.231825"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Bjørn Tore Kopperud. Author, maintainer. Sebastian Höhna. Author.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kopperud B, Höhna S (2023). Pesto: Phylogenetic Estimation Shifts Tempo Origination. R package version 0.0.1.9000.","code":"@Manual{,   title = {Pesto: Phylogenetic Estimation of Shifts in the Tempo of Origination},   author = {Bjørn Tore Kopperud and Sebastian Höhna},   year = {2023},   note = {R package version 0.0.1.9000}, }"},{"path":"/index.html","id":"pesto-phylogenetic-estimation-of-shifts-in-the-tempo-of-origination","dir":"","previous_headings":"","what":"Pesto: Phylogenetic Estimation of Shifts in the Tempo of Origination","title":"Phylogenetic Estimation of Shifts in the Tempo of Origination","text":"R-package wrapper Julia module name. program can fit state-dependent speciation extinction (SSE) models reconstructed phylogenetic trees. use models make inferences , branches, shifts tempo process diversification. See link (link)[link] documentation.","code":""},{"path":"/reference/Pesto.html","id":null,"dir":"Reference","previous_headings":"","what":"Pesto: Phylogenetic Estimation of Shifts in the Tempo of Origination — Pesto","title":"Pesto: Phylogenetic Estimation of Shifts in the Tempo of Origination — Pesto","text":"package implements birth-death shift model diversification analysis based reconstructed phylogenies.","code":""},{"path":"/reference/Pesto.html","id":"pesto-functions","dir":"Reference","previous_headings":"","what":"Pesto functions","title":"Pesto: Phylogenetic Estimation of Shifts in the Tempo of Origination — Pesto","text":"Functions ...","code":""},{"path":"/reference/allpairwise.html","id":null,"dir":"Reference","previous_headings":"","what":"All pairwise combinations among x and y — allpairwise","title":"All pairwise combinations among x and y — allpairwise","text":"pairwise combinations among x y","code":""},{"path":"/reference/allpairwise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"All pairwise combinations among x and y — allpairwise","text":"","code":"allpairwise(xs, ys)"},{"path":"/reference/allpairwise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"All pairwise combinations among x and y — allpairwise","text":"xs","code":""},{"path":"/reference/allpairwise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"All pairwise combinations among x and y — allpairwise","text":"pairwise combinations","code":""},{"path":"/reference/allpairwise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"All pairwise combinations among x and y — allpairwise","text":"","code":"n <- 6 H <- 0.578  lambda_quantiles <- lognorm_quantiles(meanlog = log(0.28), sdlog = H, n = n) mu_quantiles <- lognorm_quantiles(meanlog = log(0.20), sdlog = H, n = n)  allpairwise(lambda_quantiles, mu_quantiles) #> [[1]] #>  [1] 0.1258913 0.1896034 0.2479339 0.3162134 0.4134947 0.6227594 0.1258913 #>  [8] 0.1896034 0.2479339 0.3162134 0.4134947 0.6227594 0.1258913 0.1896034 #> [15] 0.2479339 0.3162134 0.4134947 0.6227594 0.1258913 0.1896034 0.2479339 #> [22] 0.3162134 0.4134947 0.6227594 0.1258913 0.1896034 0.2479339 0.3162134 #> [29] 0.4134947 0.6227594 0.1258913 0.1896034 0.2479339 0.3162134 0.4134947 #> [36] 0.6227594 #>  #> [[2]] #>  [1] 0.08992237 0.08992237 0.08992237 0.08992237 0.08992237 0.08992237 #>  [7] 0.13543100 0.13543100 0.13543100 0.13543100 0.13543100 0.13543100 #> [13] 0.17709561 0.17709561 0.17709561 0.17709561 0.17709561 0.17709561 #> [19] 0.22586669 0.22586669 0.22586669 0.22586669 0.22586669 0.22586669 #> [25] 0.29535335 0.29535335 0.29535335 0.29535335 0.29535335 0.29535335 #> [31] 0.44482813 0.44482813 0.44482813 0.44482813 0.44482813 0.44482813 #>"},{"path":"/reference/backwards.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — backwards","title":"Title — backwards","text":"Title","code":""},{"path":"/reference/backwards.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — backwards","text":"","code":"backwards(lambda, mu, eta, tstart, tend, E0, D0, ntimes)"},{"path":"/reference/backwards.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — backwards","text":"ntimes","code":""},{"path":[]},{"path":"/reference/bears.html","id":null,"dir":"Reference","previous_headings":"","what":"Bears phylogenetic tree — bears","title":"Bears phylogenetic tree — bears","text":"example tree taken RevBayes tutorial website","code":""},{"path":"/reference/bears.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Bears phylogenetic tree — bears","text":"","code":"data(bears)"},{"path":"/reference/bears.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Bears phylogenetic tree — bears","text":"object class phylo length 5.","code":""},{"path":"/reference/birth_death_shift.html","id":null,"dir":"Reference","previous_headings":"","what":"Branch-specific speciation and extinction rate estimation — birth_death_shift","title":"Branch-specific speciation and extinction rate estimation — birth_death_shift","text":"Branch-specific speciation extinction rate estimation","code":""},{"path":"/reference/birth_death_shift.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Branch-specific speciation and extinction rate estimation — birth_death_shift","text":"","code":"birth_death_shift(phy, lambda, mu, eta, rho, verbose = FALSE)"},{"path":"/reference/birth_death_shift.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Branch-specific speciation and extinction rate estimation — birth_death_shift","text":"verbose","code":""},{"path":[]},{"path":"/reference/birth_death_shift.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Branch-specific speciation and extinction rate estimation — birth_death_shift","text":"","code":"library(Pesto) library(ape) library(ggtree) #> ggtree v3.5.0.900 For help: #> https://yulab-smu.top/treedata-book/ #>  #> If you use the ggtree package suite in published research, please cite #> the appropriate paper(s): #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #> LG Wang, TTY Lam, S Xu, Z Dai, L Zhou, T Feng, P Guo, CW Dunn, BR #> Jones, T Bradley, H Zhu, Y Guan, Y Jiang, G Yu. treeio: an R package #> for phylogenetic tree input and output with richly annotated and #> associated data. Molecular Biology and Evolution. 2020, 37(2):599-603. #> doi: 10.1093/molbev/msz240 #>  #> S Xu, Z Dai, P Guo, X Fu, S Liu, L Zhou, W Tang, T Feng, M Chen, L #> Zhan, T Wu, E Hu, Y Jiang, X Bo, G Yu. ggtreeExtra: Compact #> visualization of richly annotated phylogenetic data. Molecular Biology #> and Evolution. 2021, 38(9):4039-4042. doi: 10.1093/molbev/msab166  #>  #> Attaching package: ‘ggtree’ #> The following object is masked from ‘package:ape’: #>  #>     rotate library(tidytree) #> If you use the ggtree package suite in published research, #> please cite the appropriate paper(s): #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #> Guangchuang Yu, Tommy Tsan-Yuk Lam, Huachen Zhu, Yi Guan. Two methods #> for mapping and visualizing associated data on phylogeny using ggtree. #> Molecular Biology and Evolution. 2018, 35(12):3041-3043. #> doi:10.1093/molbev/msy194  #>  #> Attaching package: ‘tidytree’ #> The following object is masked from ‘package:stats’: #>  #>     filter library(ggplot2) library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union  data(primates)  lambda <- c(0.1, 0.2, 0.3, 0.4, 0.20) mu <- c(0.05, 0.15, 0.05, 0.15, 0.25) rho <- 0.67 eta <- 0.008  td <- birth_death_shift(primates, lambda, mu, eta, rho) #> Julia version 1.8.2 at location /home/bkopper/.local/share/R/JuliaCall/julia/1.8.2/julia-1.8.2/bin will be used. #> Loading setup script for JuliaCall... #> Finish loading setup script for JuliaCall.  th <- max(node.depth.edgelength(primates)) p1 <- ggtree(td, aes(color = `Speciation rate`)) +              geom_tiplab(size = 3) +              theme(legend.position = c(0.15, 0.8)) +              xlim(c(0.0, th + 10))  plot(p1)"},{"path":"/reference/birth_death_shift2.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — birth_death_shift2","title":"Title — birth_death_shift2","text":"Title","code":""},{"path":"/reference/birth_death_shift2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — birth_death_shift2","text":"","code":"birth_death_shift2(phy, lambda, mu, eta, rho, verbose = FALSE)"},{"path":"/reference/birth_death_shift2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — birth_death_shift2","text":"verbose","code":""},{"path":[]},{"path":"/reference/birth_death_shift2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Title — birth_death_shift2","text":"","code":"library(Pesto) library(ape) library(ggtree) #> ggtree v3.5.0.900 For help: #> https://yulab-smu.top/treedata-book/ #>  #> If you use the ggtree package suite in published research, please cite #> the appropriate paper(s): #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #> S Xu, Z Dai, P Guo, X Fu, S Liu, L Zhou, W Tang, T Feng, M Chen, L #> Zhan, T Wu, E Hu, Y Jiang, X Bo, G Yu. ggtreeExtra: Compact #> visualization of richly annotated phylogenetic data. Molecular Biology #> and Evolution. 2021, 38(9):4039-4042. doi: 10.1093/molbev/msab166 #>  #> LG Wang, TTY Lam, S Xu, Z Dai, L Zhou, T Feng, P Guo, CW Dunn, BR #> Jones, T Bradley, H Zhu, Y Guan, Y Jiang, G Yu. treeio: an R package #> for phylogenetic tree input and output with richly annotated and #> associated data. Molecular Biology and Evolution. 2020, 37(2):599-603. #> doi: 10.1093/molbev/msz240  #>  #> Attaching package: ‘ggtree’ #> The following object is masked from ‘package:ape’: #>  #>     rotate library(tidytree) #> If you use the ggtree package suite in published research, #> please cite the appropriate paper(s): #>  #> Guangchuang Yu. Using ggtree to visualize data on tree-like structures. #> Current Protocols in Bioinformatics. 2020, 69:e96. doi:10.1002/cpbi.96 #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #>  #> Attaching package: ‘tidytree’ #> The following object is masked from ‘package:stats’: #>  #>     filter library(ggplot2) library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union  data(primates)  lambda <- c(0.1, 0.2, 0.3, 0.4, 0.20) mu <- c(0.05, 0.15, 0.05, 0.15, 0.25) rho <- 0.67 eta <- 0.008  td <- birth_death_shift2(primates, lambda, mu, eta, rho) #> Julia version 1.8.2 at location /home/bkopper/.local/share/R/JuliaCall/julia/1.8.2/julia-1.8.2/bin will be used. #> Loading setup script for JuliaCall... #> Finish loading setup script for JuliaCall.  th <- max(ape::node.depth.edgelength(primates)) p1 <- ggtree::ggtree(td, ggplot2::aes(color = `Speciation rate`)) +              ggtree::geom_tiplab(size = 3) +              ggplot2::theme(legend.position = c(0.15, 0.8)) +              ggplot2::xlim(c(0.0, th + 10))  plot(p1)"},{"path":"/reference/birth_death_shift3.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — birth_death_shift3","title":"Title — birth_death_shift3","text":"Title","code":""},{"path":"/reference/birth_death_shift3.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — birth_death_shift3","text":"","code":"birth_death_shift3(phy, lambda, mu, eta, rho, verbose = FALSE)"},{"path":"/reference/birth_death_shift3.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — birth_death_shift3","text":"phy object class phylo lambda vector speciation rates mu vector extinction rates eta (common) rate change state state j. scalar","code":""},{"path":[]},{"path":"/reference/birth_death_shift3.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Title — birth_death_shift3","text":"","code":"library(BDS) library(ape) library(ggtree) #> ggtree v3.5.0.900 For help: #> https://yulab-smu.top/treedata-book/ #>  #> If you use the ggtree package suite in published research, please cite #> the appropriate paper(s): #>  #> Guangchuang Yu, David Smith, Huachen Zhu, Yi Guan, Tommy Tsan-Yuk Lam. #> ggtree: an R package for visualization and annotation of phylogenetic #> trees with their covariates and other associated data. Methods in #> Ecology and Evolution. 2017, 8(1):28-36. doi:10.1111/2041-210X.12628 #>  #> LG Wang, TTY Lam, S Xu, Z Dai, L Zhou, T Feng, P Guo, CW Dunn, BR #> Jones, T Bradley, H Zhu, Y Guan, Y Jiang, G Yu. treeio: an R package #> for phylogenetic tree input and output with richly annotated and #> associated data. Molecular Biology and Evolution. 2020, 37(2):599-603. #> doi: 10.1093/molbev/msz240 #>  #> G Yu. Data Integration, Manipulation and Visualization of Phylogenetic #> Trees (1st ed.). Chapman and Hall/CRC. 2022. ISBN: 9781032233574  #>  #> Attaching package: ‘ggtree’ #> The following object is masked from ‘package:ape’: #>  #>     rotate library(tidytree) #> If you use the ggtree package suite in published research, #> please cite the appropriate paper(s): #>  #> Guangchuang Yu. Using ggtree to visualize data on tree-like structures. #> Current Protocols in Bioinformatics. 2020, 69:e96. doi:10.1002/cpbi.96 #>  #> Guangchuang Yu, Tommy Tsan-Yuk Lam, Huachen Zhu, Yi Guan. Two methods #> for mapping and visualizing associated data on phylogeny using ggtree. #> Molecular Biology and Evolution. 2018, 35(12):3041-3043. #> doi:10.1093/molbev/msy194  #>  #> Attaching package: ‘tidytree’ #> The following object is masked from ‘package:stats’: #>  #>     filter library(ggplot2) library(dplyr) #>  #> Attaching package: ‘dplyr’ #> The following objects are masked from ‘package:stats’: #>  #>     filter, lag #> The following objects are masked from ‘package:base’: #>  #>     intersect, setdiff, setequal, union  data(bears)  lambda <- c(0.1, 0.2) mu <- c(0.05, 0.15) rho <- 1.0 eta <- 0.05  res <- birth_death_shift3(bears, lambda, mu, eta, rho) #> Julia version 1.8.2 at location /home/bkopper/.local/share/R/JuliaCall/julia/1.8.2/julia-1.8.2/bin will be used. #> Loading setup script for JuliaCall... #> Finish loading setup script for JuliaCall. lambda_average <- res$lambda  th <- max(node.depth.edgelength(bears)) df1 <- tibble(\"node\" = 1:max(bears$edge),               \"Speciation rate\" = lambda_average) x <- as_tibble(bears)  bearsdf <- merge(x, df1, by = \"node\") td_bears <- as.treedata(bearsdf)  p1a <- ggtree(td_bears, aes(color = `Speciation rate`)) +   geom_tiplab(size = 8) +   theme(legend.position = c(0.2, 0.8)) +   xlim(c(0.0, th + 10))"},{"path":"/reference/compute_nshifts.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the expected number of shifts in rate category per branch — compute_nshifts","title":"Compute the expected number of shifts in rate category per branch — compute_nshifts","text":"Compute expected number shifts rate category per branch","code":""},{"path":"/reference/compute_nshifts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the expected number of shifts in rate category per branch — compute_nshifts","text":"","code":"compute_nshifts(phy, lambda, mu, eta, rho, ntimeslices = 500)"},{"path":"/reference/compute_nshifts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the expected number of shifts in rate category per branch — compute_nshifts","text":"ntimeslices","code":""},{"path":[]},{"path":"/reference/compute_nshifts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Compute the expected number of shifts in rate category per branch — compute_nshifts","text":"","code":"library(Pesto) library(ggtree) library(ggplot2) data(primates)  lambda <- c(0.1, 0.2, 0.3, 0.4) mu <- c(0.05, 0.15, 0.05, 0.15) eta <- 0.008 rho <- 0.67  td <- compute_nshifts(primates, lambda, mu, eta, rho)  th <- max(ape::node.depth.edgelength(primates)) p1 <- ggtree(td, aes(color = nshifts)) +              geom_tiplab(size = 3) +              theme(legend.position = c(0.15, 0.8)) +              xlim(c(0.0, th + 10)) +              scale_colour_gradient(low = \"black\", high = \"red\")  plot(p1)"},{"path":"/reference/estimate_constant_bdp.html","id":null,"dir":"Reference","previous_headings":"","what":"ML estimation of rates under the constant-rate Birth-Death process — estimate_constant_bdp","title":"ML estimation of rates under the constant-rate Birth-Death process — estimate_constant_bdp","text":"ML estimation rates constant-rate Birth-Death process","code":""},{"path":"/reference/estimate_constant_bdp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"ML estimation of rates under the constant-rate Birth-Death process — estimate_constant_bdp","text":"","code":"estimate_constant_bdp(phy, rho = 1)"},{"path":"/reference/estimate_constant_bdp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"ML estimation of rates under the constant-rate Birth-Death process — estimate_constant_bdp","text":"phy object class phylo rho taxon sampling fraction. Must 0.0 maximum 1.0","code":""},{"path":[]},{"path":"/reference/estimate_constant_bdp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"ML estimation of rates under the constant-rate Birth-Death process — estimate_constant_bdp","text":"","code":"library(Pesto)  data(primates) rho <- 0.67  res <- estimate_constant_bdp(primates, rho)"},{"path":"/reference/extinction_probability.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute the extinction probability E(t) — extinction_probability","title":"Compute the extinction probability E(t) — extinction_probability","text":"Compute extinction probability E(t)","code":""},{"path":"/reference/extinction_probability.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute the extinction probability E(t) — extinction_probability","text":"","code":"extinction_probability(phy, lambda, mu, rho)"},{"path":"/reference/extinction_probability.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute the extinction probability E(t) — extinction_probability","text":"rho","code":""},{"path":[]},{"path":"/reference/lognorm_quantiles.html","id":null,"dir":"Reference","previous_headings":"","what":"lognormal quantiles — lognorm_quantiles","title":"lognormal quantiles — lognorm_quantiles","text":"lognormal quantiles","code":""},{"path":"/reference/lognorm_quantiles.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"lognormal quantiles — lognorm_quantiles","text":"","code":"lognorm_quantiles(meanlog = log(0.2), sdlog = 0.587, n = 6)"},{"path":"/reference/lognorm_quantiles.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"lognormal quantiles — lognorm_quantiles","text":"meanlog mean normal distribution log scale sdlog standard deviation normal distribution log scale. sdlog = 0.587 represents distribution whose 2.5-97.5% quantile spans one order magnitude k number discrete quantiles returned","code":""},{"path":[]},{"path":[]},{"path":"/reference/optimize_eta.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate the shift rate conditional on lambda and mu — optimize_eta","title":"Estimate the shift rate conditional on lambda and mu — optimize_eta","text":"finds maximum-likelihood eta conditional vectors lambda mu, using gradient descent. typically evaluate likelihood function around 20-60 times, also derivative likelihood function respect eta, instantaneous. Check result stuck lower upper bounds.","code":""},{"path":"/reference/optimize_eta.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate the shift rate conditional on lambda and mu — optimize_eta","text":"","code":"optimize_eta(lambda, mu, phy, rho, lower = 1e-05, upper = 10, eta0 = NULL)"},{"path":"/reference/optimize_eta.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate the shift rate conditional on lambda and mu — optimize_eta","text":"lambda vector speciation rates mu vector extinction rates phy object class phylo lower lower limit numerical optimization eta upper upper limit numerical optimization eta eta0 starting value eta","code":""},{"path":[]},{"path":"/reference/optimize_eta.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate the shift rate conditional on lambda and mu — optimize_eta","text":"","code":"library(Pesto) data(primates)  lambda <- c(0.1, 0.2, 0.3, 0.4) mu <- c(0.05, 0.15, 0.05, 0.15) rho <- 0.67  etaml <- optimize_eta(lambda, mu, primates, rho) print(etaml) #> [1] 0.001658334"},{"path":"/reference/primates.html","id":null,"dir":"Reference","previous_headings":"","what":"Primates phylogenetic tree — primates","title":"Primates phylogenetic tree — primates","text":"example tree taken RevBayes tutorial website","code":""},{"path":"/reference/primates.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Primates phylogenetic tree — primates","text":"","code":"data(primates)"},{"path":"/reference/primates.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Primates phylogenetic tree — primates","text":"object class phylo length 5.","code":""},{"path":"/reference/traversal.html","id":null,"dir":"Reference","previous_headings":"","what":"Title — traversal","title":"Title — traversal","text":"Title","code":""},{"path":"/reference/traversal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Title — traversal","text":"","code":"traversal(phy, D_inits, lambda, mu, eta, ntimes = 100, printlogL = FALSE)"},{"path":"/reference/traversal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Title — traversal","text":"ntimes","code":""},{"path":[]},{"path":"/reference/treeprecompute.html","id":null,"dir":"Reference","previous_headings":"","what":"Precompute tree statistics — treeprecompute","title":"Precompute tree statistics — treeprecompute","text":"Add tree statistics tree object, compute branch traversal order (postorder).","code":""},{"path":"/reference/treeprecompute.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Precompute tree statistics — treeprecompute","text":"","code":"treeprecompute(phy)"},{"path":"/reference/treeprecompute.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Precompute tree statistics — treeprecompute","text":"phy","code":""},{"path":[]},{"path":"/reference/treeprecompute.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Precompute tree statistics — treeprecompute","text":"","code":"library(Pesto)  data(bears)  bears <- treeprecompute(bears)"}]
